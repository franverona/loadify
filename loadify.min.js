/**
 * Copyright (c) 2013 Fran Verona
 *
 * Permission is hereby granted, free of charge, to any
 * person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the
 * Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the
 * Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice
 * shall be included in all copies or substantial portions of
 * the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY
 * KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
 * PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR
 * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * JQuery Loadify v1.0
 * Release Date: March, 2013
 *  
 * Provide simple methods to put a mask over elements to simulate "Loading" functions
 */
if(jQuery){(function(a){a.extend(a.fn,{loadify:function(b){var c={canvas:true,style:"default",color:"#ffffff",textcolor:"#000000",circlecolor:"#BDBDBD",bigcolor:"#000000",message:"",fontfamily:"Arial",fontsize:16};a(this).data("loadify",$.extend(true,{},c,b))},load:function(){function c(w,r){var p=w.find("#jquery-loading-canvas")[0],t=p.getContext("2d"),k=Math,s=w,q=r.width,u=r.height;p.width=q;p.height=u;function j(m){m=m||true;this.r=25;if(!m){this.position={x:q/2,y:u/2}}else{this.position={x:q/2,y:u/2-20}}this.angle=0;this.arrowangle=-90;this.tailangle1=0.45;this.tailangle2=160.8;if(!m){this.squareposition={x:q/2-75,y:u/2}}else{this.squareposition={x:q/2-75,y:u/2-20}}this.square=0;function l(x,B){t.beginPath();var y=arrowEndPointX=x-7;var A=B-6;var z=B+6;t.beginPath();t.moveTo(y,A);t.lineTo(x,B);t.lineTo(arrowEndPointX,z);t.lineTo(x,B);t.moveTo(y,A);t.closePath();t.lineWidth=3;t.stroke()}this.draw=function(C){switch(C){case"default":for(var D=0;D<14;D++){var F=this.position.x+((this.r)*k.cos((D*30)*(k.PI/180)));var E=this.position.y+((this.r)*k.sin((D*30)*(k.PI/180)));t.beginPath();t.arc(F,E,4,0,2*Math.PI,false);t.fillStyle=r.circlecolor;t.fill();t.closePath()}var F=this.position.x+((this.r)*k.cos((this.angle)*(k.PI/180)));var E=this.position.y+((this.r)*k.sin((this.angle)*(k.PI/180)));t.beginPath();t.arc(F,E,6,0,2*Math.PI,false);t.fillStyle=r.bigcolor;t.fill();t.closePath();this.angle+=30;break;case"circle":for(var D=0;D<4;D++){var F=this.position.x+((this.r)*k.cos((this.angle)*(k.PI/180)));var E=this.position.y+((this.r)*k.sin((this.angle)*(k.PI/180)));t.beginPath();t.arc(F,E,4,0,2*Math.PI,false);t.fillStyle=r.circlecolor;t.fill();t.closePath();this.angle+=20}this.angle+=5;var F=this.position.x+((this.r)*k.cos((this.angle)*(k.PI/180)));var E=this.position.y+((this.r)*k.sin((this.angle)*(k.PI/180)));t.beginPath();t.arc(F,E,5,0,2*Math.PI,false);t.fillStyle=r.bigcolor;t.fill();t.closePath();this.angle-=40;break;case"bigroller":for(var D=0;D<10;D++){var F=this.position.x+((this.r)*k.cos((this.angle+D*40)*(k.PI/180)));var E=this.position.y+((this.r)*k.sin((this.angle+D*40)*(k.PI/180)));t.beginPath();t.arc(F,E,D,0,2*Math.PI,false);t.fillStyle=r.bigcolor;t.fill();t.closePath()}this.angle+=15;break;case"arrows":var G=this.position.x+((this.r)*k.cos((this.arrowangle)*(k.PI/180)));var z=this.position.y+((this.r)*k.sin((this.arrowangle)*(k.PI/180)));t.save();t.translate(G,z);t.rotate(this.angle*(Math.PI/180));l(0,0);t.restore();t.beginPath();t.arc(this.position.x,this.position.y,this.r,this.tailangle1,this.tailangle1+k.PI/3,false);t.lineWidth="3";t.stroke();t.closePath();var A=this.position.x+((this.r)*k.cos((this.arrowangle+180)*(k.PI/180)));var B=this.position.y+((this.r)*k.sin((this.arrowangle+180)*(k.PI/180)));t.save();t.translate(A,B);t.rotate((this.angle+180)*(Math.PI/180));l(0,0);t.restore();t.beginPath();t.arc(this.position.x,this.position.y,this.r,this.tailangle2,this.tailangle2+k.PI/3,false);t.lineWidth="3";t.stroke();t.closePath();this.angle+=20;this.tailangle1+=k.PI/9;this.tailangle2+=k.PI/9;this.arrowangle+=20;break;case"squares":for(var D=0;D<6;D++){t.fillStyle=r.circlecolor;if(D==this.square){t.fillStyle=r.bigcolor}t.fillRect(this.squareposition.x+D*30,this.squareposition.y,15,15)}this.square=(this.square+1)%6;break}}}function n(z,l,m){this.msg=z;this.position={x:l,y:m};this.draw=function(){t.font=r.fontsize+"px "+r.fontfamily;t.textAlign="start";t.fillStyle=r.textcolor;var x=t.measureText(this.msg).width;this.position.x=q/2-x/2;t.fillText(this.msg,this.position.x,this.position.y)}}var v,o;if(r.message!=""){v=new j();o=new n(r.message,v.position.x-v.r+40,v.position.y+v.r+40)}else{v=new j(false)}s.data("interval",setInterval(function(){t.fillStyle=r.color;t.fillRect(0,0,q,u);v.draw(r.style);if(o){o.draw()}},100))}function d(){var k=-1;if(navigator.appName=="Microsoft Internet Explorer"){var j=navigator.userAgent;var l=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(l.exec(j)!=null){k=parseFloat(RegExp.$1)}}if((navigator.appName=="Microsoft Internet Explorer")&&((k==6)||(k==7))){return false}return true}var h=a(this),g=h.data("loadify"),e=['<div class="jquery-loading">','<canvas id="jquery-loading-canvas"></canvas>',"</div>"],i=['<div class="jquery-loading-content">',h.html(),"</div>"];h.empty();h.append(i.join(""));h.css("position","relative");h.data("padding",h.css("padding")[0]);h.css("padding","0");if(d()&&g.canvas){h.append(e.join(""));var b={width:h.width(),height:h.height()};b=$.extend(true,{},g,b);c(h,b)}else{e=['<div class="jquery-loading">','<div class="jquery-loading-img">',"</div>",'<div class="jquery-loading-text">',g.message,"</div>","</div>"];h.append(e.join(""));var f=h.height()/2-30;h.find(".jquery-loading-img").css("margin-top",f+"px");h.find(".jquery-loading").css({"background-color":g.color});h.find(".jquery-loading-text").css({color:g.textcolor,"font-family":g.fontfamily,"font-size":g.fontsize})}},unload:function(){var e=a(this),c=e.find(".jquery-loading-content").html(),d=e.data("interval"),b=e.data("padding");e.find(".jquery-loading").remove();e.find(".jquery-loading-content").remove();e.html(c);e.css("padding",b);if(d){clearInterval(d)}}})})(jQuery)};